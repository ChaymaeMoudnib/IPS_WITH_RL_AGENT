# ğŸ›¡ï¸ Network Intrusion Detection & Prevention System (IDPS) with Reinforcement Learning

A modern, hybrid Intrusion Detection and Prevention System that combines traditional Snort-style rule-based detection with Reinforcement Learning (RL) for adaptive, intelligent network security.  
Monitor, detect, and respond to threats in real time, with a user-friendly GUI and advanced alerting.


## âœ¨ Features

### Core Functionality
- **Real-time packet capture** (using Pcap4J)
- **Rule-based detection** (Snort rules, custom rules)
- **Reinforcement Learning agent** for adaptive threat response
- **Multi-threaded** processing for high performance
- **Comprehensive statistics**: protocol, traffic, alerts, RL accuracy

### Security & Detection
- Detects:  
  - XSS attacks  
  - SQL injection  
  - Port scans    
  - Custom Snort rules (ICMP, TCP, UDP, etc.)
- **Anomaly detection** (heuristics + RL)
- **Active/Passive blocking** (configurable)
- **Alert severity**: CRITICAL, HIGH, MEDIUM, LOW

### GUI Highlights
- **Control Panel**: Start/stop capture, select interface, toggle RL
- **Simulation Panel**: Simulate XSS, SQLi, Port Scan, Snort rule tests
- **Packet Display**: Live packet info
- **Statistics Panel**: Traffic, RL stats, accuracy
- **Log Panel**: Alerts, events, exportable logs
- **RL Decisions Panel**: RL agent actions, confidence, learning

### Alerting & Logging
- **Visual alerts** in GUI (color-coded, icons)
- **Email notifications** for HIGH/CRITICAL alerts (configurable)
- **Persistent log files** (`logs/ids_YYYY-MM-DD.log`)
- **Export logs** for analysis

### Extensibility
- Add new rules in `rules/snort.rules`
- Plug in new RL models (`trained_model.rl`)
- Modular codebase for easy feature addition

---

## ğŸ“‹ Prerequisites

- Java 17+
- Maven 3.6+
- Admin/root privileges for packet capture
- Network interface with promiscuous mode

---

## ğŸ“¦ Dependencies

See `pom.xml` for all dependencies.  
Key libraries:
- `pcap4j-core` (packet capture)
- `flatlaf` (modern GUI)
- `logback-classic` (logging)
- `junit` (testing)

---

## ğŸš€ Installation

```bash
git clone https://github.com/ChaymaeMoudnib/IPS_WITH_RL_AGENT
cd IPS_WITH_RL_AGENT
mvn clean install
```

---

## âš™ï¸ Configuration

### Network Interface
- Windows: `\Device\NPF_{GUID}`
- Linux: `eth0`, `wlan0`
- macOS: `en0`, `en1`

### Rules
- Place Snort rules in `rules/snort.rules`
- Use standard Snort syntax (see [Snort Docs](https://www.snort.org/documents))

### RL Model
- Place your RL model as `trained_model.rl` in the project root

### Email Alerts
- Configure via GUI: "Configure Email Alerts" button
- Requires Gmail address and App Password (see help in dialog)

---

## ğŸ® Usage

### Start the Application
```bash
java -jar target/network-ids-rl.jar
```
- Select interface, click "Start"
- Use simulation buttons to test detection (XSS, SQLi, Port Scan, Snort rules)
- Monitor all panels for live feedback

### Stopping & Exporting
- Click "Stop" to end capture
- Logs are saved in `logs/`
- Export logs via GUI or manually

---

## ğŸ§ª Simulation Scenarios

- **DDoS**: `hping3 -S -p 80 --flood <target>`
- **SQL Injection**: `curl "http://target.com/login.php?username=admin' OR '1'='1"`
- **Port Scan**: `nmap -sS -p 1-1000 <target>`
- **Snort Rule Test**: Add a rule, generate matching traffic

---

## ğŸ—ï¸ Project Structure

```
IPS_WITH_RL_AGENT/
IPS_WITH_RL_AGENT/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚   â”‚       â””â”€â”€ example/
â”‚   â”‚   â”‚           â”œâ”€â”€ capture/         # Packet capture implementation
â”‚   â”‚   â”‚           â”œâ”€â”€ detection/       # Rule engine, anomaly detection, alert classes
â”‚   â”‚   â”‚           â”œâ”€â”€ gui/             # GUI components (panels, main window, etc.)
â”‚   â”‚   â”‚           â”œâ”€â”€ logging/         # Logging utilities
â”‚   â”‚   â”‚           â”œâ”€â”€ rl/              # Reinforcement Learning agent and environment
â”‚   â”‚   â”‚           â”œâ”€â”€ util/            # Utility classes (rule parsing, validation, email, etc.)
â”‚   â”‚   â”‚           â”œâ”€â”€ engine/          # Core engine logic
â”‚   â”‚   â”‚           â”œâ”€â”€ producer/        # Producer logic for packets/events
â”‚   â”‚   â”‚           â”œâ”€â”€ consumer/        # Consumer logic for packets/events
â”‚   â”‚   â”‚           â”œâ”€â”€ concurrent/      # Concurrency helpers
â”‚   â”‚   â”‚           â”œâ”€â”€ designpatterns/  # Design pattern implementations
â”‚   â”‚   â”‚           â”œâ”€â”€ Main.java        # Main entry point
â”‚   â”‚   â”‚           â””â”€â”€ IDPSController.java                  # Main controller class
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ icons/                   # GUI icons and images
â”‚   â”‚       â””â”€â”€ rules/                   # Snort rules file(s)
â”œâ”€â”€ logs/                                # Log files generated by the system
â”œâ”€â”€ rules/                               # Directory for Snort rules
â”œâ”€â”€ pom.xml                              # Maven build configuration
â”œâ”€â”€ README.md                            # Project documentation
â”œâ”€â”€
â””â”€â”€ 
```

---

## ğŸ› ï¸ Development & Extending

- Add new rules in `rules/snort.rules`
- Add new detection logic in `detection/`
- Add new RL models in `rl/`
- Update GUI in `gui/`
- Run tests: `mvn test`

---

## ğŸ¤ Contributing

- Fork, branch, commit, PR!

---

## ğŸ“„ License

MIT License (see LICENSE)

---

## ğŸ“ Contact

Open an issue on GitHub for support.

---

## ğŸ“š Resources

- [Snort Documentation](https://www.snort.org/documents)
- [Pcap4J Documentation](https://www.pcap4j.org/)
- [Reinforcement Learning Tutorial](https://www.tensorflow.org/agents/tutorials/intro_rl)
- [Network Security Best Practices](https://www.cisa.gov/cybersecurity)

